#
# ptbuildopts.mak
#
# mak rules to be included in a ptlib application Makefile.
#
# Portable Tools Library
#
# Copyright (c) 1993-2013 Equivalence Pty. Ltd.
#
# The contents of this file are subject to the Mozilla Public License
# Version 1.0 (the "License"); you may not use this file except in
# compliance with the License. You may obtain a copy of the License at
# http://www.mozilla.org/MPL/
#
# Software distributed under the License is distributed on an "AS IS"
# basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See
# the License for the specific language governing rights and limitations
# under the License.
#
# The Original Code is Portable Windows Library.
#
# The Initial Developer of the Original Code is Equivalence Pty. Ltd.
#
# Portions are Copyright (C) 1993 Free Software Foundation, Inc.
# All Rights Reserved.
# 
# Contributor(s): ______________________________________.
#
# $Revision$
# $Author$
# $Date$
#

PTLIB_MAJOR :=@PTLIB_MAJOR@
PTLIB_MINOR :=@PTLIB_MINOR@
PTLIB_STAGE :=@PTLIB_STAGE@
PTLIB_BUILD :=@PTLIB_BUILD@

# detected platform
target      := @target@
target_os   := @target_os@
target_cpu  := @target_cpu@

# The install directories
prefix      := @prefix@
exec_prefix := @exec_prefix@
libdir      := @libdir@
includedir       := @includedir@
datarootdir      := @datarootdir@

# Tool names detected by configure
CC	:= @CC@
CXX	:= @CXX@
LD      := @LD@
AR	:= @AR@
RANLIB  := @RANLIB@
LN_S    := @LN_S@
MKDIR_P := @MKDIR_P@
YACC    := @YACC@
INSTALL := @INSTALL@
SVN     := @SVN@

CPPFLAGS          := @CPPFLAGS@ $(CPPFLAGS)
CXXFLAGS          := @CXXFLAGS@ $(CXXFLAGS)
CFLAGS            := @CFLAGS@ $(CFGLAGS)
LDFLAGS	          := @LDFLAGS@ $(LDFLAGS)
SHARED_CPPFLAGS   := @SHARED_CPPFLAGS@
SHARED_LDFLAGS    := @SHARED_LDFLAGS@
DEBUG_FLAGS       := @DEBUG_FLAGS@
OPT_FLAGS         := @OPT_FLAGS@
ARFLAGS           := @ARFLAGS@

SHAREDLIBEXT	  := @SHAREDLIBEXT@
STATICLIBEXT	  := @STATICLIBEXT@

DEV_PLUGIN_DIR    := @DEV_PLUGIN_DIR@
PTLIB_PLUGIN_DIR  := @PTLIB_PLUGIN_DIR@

HAS_IPV6          := @HAS_IPV6@
HAS_DNS_RESOLVER  := @HAS_DNS_RESOLVER@
HAS_PCAP          := @HAS_PCAP@
HAS_OPENSSL 	  := @HAS_OPENSSL@
HAS_SSL 	  := @HAS_OPENSSL@
HAS_OPENLDAP	  := @HAS_OPENLDAP@
HAS_LDAP	  := @HAS_OPENLDAP@
HAS_SASL	  := @HAS_SASL@
HAS_SASL2	  := @HAS_SASL2@
HAS_EXPAT	  := @HAS_EXPAT@
HAS_REGEX	  := @HAS_REGEX@
HAS_SDL		  := @HAS_SDL@
HAS_PLUGINS	  := @HAS_PLUGINS@
HAS_SAMPLES	  := @HAS_SAMPLES@

HAS_TTS		  := @HAS_TTS@
HAS_ASN		  := @HAS_ASN@
HAS_NAT		  := @HAS_NAT@
HAS_STUN	  := @HAS_STUN@
HAS_STUNSRVR	  := @HAS_STUNSRVR@
HAS_PIPECHAN	  := @HAS_PIPECHAN@
HAS_DTMF	  := @HAS_DTMF@
HAS_VCARD	  := @HAS_VCARD@
HAS_WAVFILE	  := @HAS_WAVFILE@
HAS_SOCKS	  := @HAS_SOCKS@
HAS_FTP		  := @HAS_FTP@
HAS_SNMP	  := @HAS_SNMP@
HAS_TELNET	  := @HAS_TELNET@
HAS_CLI		  := @HAS_CLI@
HAS_REMCONN	  := @HAS_REMCONN@
HAS_SERIAL	  := @HAS_SERIAL@
HAS_POP3SMTP	  := @HAS_POP3SMTP@
HAS_AUDIO	  := @HAS_AUDIO@
HAS_VIDEO	  := @HAS_VIDEO@
HAS_SHM_VIDEO     := @HAS_SHM_VIDEO@
HAS_SHM_AUDIO     := @HAS_SHM_AUDIO@
HAS_PORTAUDIO     := @HAS_PORTAUDIO@
HAS_SUN_AUDIO     := @HAS_SUN_AUDIO@
HAS_VFW_CAPTURE   := @HAS_VFW_CAPTURE@

HAS_VXML	  := @HAS_VXML@
HAS_JABBER	  := @HAS_JABBER@
HAS_XMLRPC	  := @HAS_XMLRPC@
HAS_SOAP	  := @HAS_SOAP@
HAS_URL		  := @HAS_URL@
HAS_HTTP	  := @HAS_HTTP@
HAS_HTTPFORMS     := @HAS_HTTPFORMS@
HAS_HTTPSVC	  := @HAS_HTTPSVC@
HAS_SSDP	  := @HAS_SSDP@
HAS_CONFIG_FILE   := @HAS_CONFIG_FILE@
HAS_VIDFILE	  := @HAS_VIDFILE@
HAS_FFVDEV	  := @HAS_FFVDEV@
HAS_ODBC          := @HAS_ODBC@
HAS_DIRECTSHOW    := @HAS_DIRECTSHOW@
HAS_DIRECTSOUND   := @HAS_DIRECTSOUND@
HAS_LUA		  := @HAS_LUA@
HAS_V8		  := @HAS_V8@


###############################################################################
#
# Determine the library name
#

ifdef PTLIBDIR
  PTLIB_INCDIR = $(PTLIBDIR)/include
  PTLIB_LIBDIR = $(PTLIBDIR)/lib_$(target)
else
  PTLIB_INCDIR = $(shell pkg-config ptlib --variable=includedir)
  PTLIB_LIBDIR = $(shell pkg-config ptlib --variable=libdir)
endif

ifndef P_SHAREDLIB
  P_SHAREDLIB=1
endif

ifdef DEBUG
  OBJ_SUFFIX := _d
else
  OBJ_SUFFIX :=
endif # DEBUG

ifndef OBJDIR_SUFFIX
  OBJDIR_SUFFIX = $(OBJ_SUFFIX)
endif

PTLIB_OBJDIR = $(PTLIB_LIBDIR)/obj$(OBJDIR_SUFFIX)

PTLIB_PREFIX := pt
PTLIB_STATIC_FILE = lib$(PTLIB_PREFIX)_s.$(STATICLIBEXT)
PTLIB_SHARED_BASE = lib$(PTLIB_PREFIX)
PTLIB_SHARED_LINK = $(PTLIB_SHARED_BASE).$(SHAREDLIBEXT)
PTLIB_DEBUG_STATIC_FILE = lib$(PTLIB_PREFIX)_d_s.$(STATICLIBEXT)
PTLIB_DEBUG_SHARED_BASE = lib$(PTLIB_PREFIX)_d
PTLIB_DEBUG_SHARED_LINK = $(PTLIB_DEBUG_SHARED_BASE).$(SHAREDLIBEXT)

PTLIB_FILE_VERSION = $(PTLIB_MAJOR).$(PTLIB_MINOR)$(PTLIB_STAGE)$(PTLIB_BUILD)

ifneq (,$(findstring $(target_os),Darwin cygwin mingw))
  PTLIB_SHARED_FILE = $(PTLIB_SHARED_BASE).$(PTLIB_FILE_VERSION).$(SHAREDLIBEXT)
  PTLIB_DEBUG_SHARED_FILE = $(PTLIB_DEBUG_SHARED_BASE).$(PTLIB_FILE_VERSION).$(SHAREDLIBEXT)
else
  PTLIB_SHARED_FILE = $(PTLIB_SHARED_BASE).$(SHAREDLIBEXT).$(PTLIB_FILE_VERSION)
  PTLIB_DEBUG_SHARED_FILE = $(PTLIB_DEBUG_SHARED_BASE).$(SHAREDLIBEXT).$(PTLIB_FILE_VERSION)
endif


###############################################################################
#
# Set up compiler flags and macros for debug/release versions
#

ifdef	DEBUG
  CPPFLAGS += $(DEBUG_FLAGS)
  LDFLAGS  += $(DEBUG_FLAGS)
else
  CPPFLAGS += $(OPT_FLAGS)
  LDFLAGS  += $(OPT_FLAGS)
endif

# End of ptbuildopts.mak

